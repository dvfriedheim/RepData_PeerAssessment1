---
title: 'Reproducible Research: Peer Assessment 1'
author: "Daniel Friedheim"
date: "April 26, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,tidy = TRUE,fig.height = 4,warning = FALSE)
```
#Activity Data Report
###Introduction

It is now possible to collect a large amount of data about personal movement using activity monitoring devices such as a *Fitbit*, *Nike Fuelband*, or *Jawbone Up*. These type of devices are part of the “quantified self” movement – a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. But these data remain under-utilized both because the raw data are hard to obtain and there is a lack of statistical methods and software for processing and interpreting the data.

This report explores data from a personal activity monitoring device. This device collects data at **5 minute intervals** through out the day. The data consists of two months of data from an anonymous individual collected during the months of **October and November, 2012** and include the **number of steps taken** in 5 minute intervals each day.

##Loading and preprocessing the data
###1. Code for reading in the dataset and/or processing the data
```{r message=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
activity<-read_csv("./data/activity.csv")
```

##What is mean total number of steps taken per day?

First of all, the **grand total** of all steps taken over this 61-day period is `r sum(activity$steps,na.rm=TRUE)`, as generated by this code:
```{r results=FALSE} 
sum(activity$steps,na.rm=TRUE)
```

###2. Histogram of the total number of steps taken **each** day:
```{r}
byDate<-group_by(activity,date)
totalByDate<-summarize(byDate,total=sum(steps))
ggplot(totalByDate,aes(total))+geom_histogram(bins=10,fill="blue")+
        labs(title="Distribution of steps/day (dirty data set)",
        x="Daily Total of Steps",y="Count of Days")+theme_minimal(base_size = 14)
```

###3. Mean and median number of steps taken each day
The **mean** total number of steps taken each day is`r as.integer(round(mean(totalByDate$total,na.rm = TRUE),0))`, and the **median** of `r as.integer(median(totalByDate$total,na.rm=TRUE))` is nearly the same, as calculated by this code: 
```{r results=FALSE}
as.integer(round(mean(totalByDate$total,na.rm = TRUE),0))
as.integer(median(totalByDate$total,na.rm=TRUE))
```
  
  
##What is the average daily activity pattern?
  
###4. Time series plot of the average number of steps taken
```{r}
byInterval<-group_by(activity,interval)
meanSteps<-summarize(byInterval,average=round(mean(steps,na.rm=TRUE),digits=0))
ggplot(meanSteps,aes(interval,average))+geom_line(col="blue")+
        theme_minimal(base_size = 14)+labs(title="Steps by 5-minute Interval",
             x="5-min. Interval in Day",y="Avg. No. of Steps")
```
  
###5. The 5-minute interval that, on average, contains the maximum number of steps
The index number of the 5-minute interval with the **highest** average number of steps across all days, and that average, are `r filter(meanSteps,average==max(average))`, respectively, as calculated by this code:
```{r message=FALSE}
filter(meanSteps,average==max(average))
```
  
  
##Imputing missing values
The **total** number of rows with the missing value of NA for *steps* is `r sum(is.na(activity$steps))`, as calculated by this code:
```{r results=FALSE}
sum(is.na(activity$steps))
```
  
###6. Code to describe and show a strategy for imputing missing data
Since the number of steps varies widely by 5-minute interval, it would be best to impute them by interval, as well. And, since the pattern of NAs is not scattered, but rather concentrated in all 288 intervals/day of just 8 out of 61 days,
we may impute a full "set" of average steps by interval for each of those days:
```{r cache=TRUE}
imputedSteps<-meanSteps$average
cleanByInterval<-byInterval
cleanByInterval[cleanByInterval$date=="2012-10-01",]$steps<-imputedSteps
cleanByInterval[cleanByInterval$date=="2012-10-08",]$steps<-imputedSteps
cleanByInterval[cleanByInterval$date=="2012-11-01",]$steps<-imputedSteps
cleanByInterval[cleanByInterval$date=="2012-11-04",]$steps<-imputedSteps
cleanByInterval[cleanByInterval$date=="2012-11-09",]$steps<-imputedSteps
cleanByInterval[cleanByInterval$date=="2012-11-10",]$steps<-imputedSteps
cleanByInterval[cleanByInterval$date=="2012-11-14",]$steps<-imputedSteps
cleanByInterval[cleanByInterval$date=="2012-11-30",]$steps<-imputedSteps
```

Just to be safe, let's confirm that there are no more NAs left and that the clean **new** dataset retains the original 17,568 records of 3 variables:
```{r}
sum(is.na(cleanByInterval$steps))
dim(cleanByInterval)
```

###7. Histogram of the total number of steps taken each day after missing values are imputed
The impact of imputing NAs is to **increase** daily totals, which shifts the new histogram slightly to **right**:  
```{r}
cleanByDate<-group_by(cleanByInterval,date)
totalCleanByDate<-summarize(cleanByDate,total=sum(steps))
ggplot(totalCleanByDate,aes(total))+geom_histogram(bins=10,fill="blue")+
        labs(title="Distribution of steps/day (clean data set)",
             x="Daily Total of Steps",y="Count of Days")+theme_minimal(base_size = 14)
```

For this clean **new** dataset, the **mean** total number of steps taken each day reamains `r as.integer(round(mean(totalCleanByDate$total,0)))`, but the **median** of `r as.integer(median(totalCleanByDate$total))` diverges a bit more than before imputing, as calculated by this code: 
```{r results=FALSE}
as.integer(round(mean(totalCleanByDate$total,0)))
as.integer(median(totalCleanByDate$total))
```
  
  
##Are there differences in activity patterns between weekdays and weekends?
  
To answer that question, let's first add a *weekday* variable, then derive from it another *daytype* variable gathering together every *weekday* and every *weekend* day:
```{r}
cleanByWeekday<-mutate(cleanByDate,weekday=(weekdays(date)))
ungroup(cleanByWeekday)
cleanByDayType<-mutate(cleanByWeekday,daytype=
        if_else(weekday %in% c("Saturday","Sunday"),
                                        "weekend","weekday"))
cleanByDayType
```
  
###8. Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends
```{r message=FALSE}
cleanMeanSteps<-summarize(group_by(cleanByDayType,interval,daytype),average=round(mean(steps),digits=0))
ggplot(cleanMeanSteps,aes(interval,average,color=daytype))+
        geom_line()+theme_minimal(base_size = 14)+facet_grid(daytype~.)+
        labs(title="Differences between Weekdays & Weekends",
             x="5-min. Interval of Day",y="Avg. No. of Steps")
```
  
  
##Note:
  
###9. All of the R code needed to reproduce the results (numbers, plots, etc.) **are** right in this report.